<!-- by @wangyizhi571247 -->
<!-- version 0.0 -->

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CF-random</title>
</head>
<body>
    <script>
        function randint(l,r) // [l,r]
        {
            return Math.floor(Math.random()*(r-l+1))+l;
        }
        var fetched=0;
        var problemset;
        function fetchProblems(callback)
        {
            if(fetched==1)
            {
                callback(problemset);
                return;
            }
            fetch('https://codeforces.com/api/problemset.problems')
                .then(response=>{
                    return response.json();
                })
                .then(data=>{
                    return data.result.problems;
                })
                .then(problems=>{
                    // console.log(problems);
                    problemset=problems;
                    fetched=1;
                    callback(problems);
                });
        }
        /*
            contestId: int
            index: string
            name: string
            rating: int
            tags: array(string)
            type: string
        */
        function newProblemLinker(problem)
        {
            const element=document.createElement("a");
            element.text=problem.contestId+problem.index+" "+problem.name+"("+problem.rating+")";
            element.href="https://codeforces.com/problemset/problem/"+problem.contestId+"/"+problem.index;
            console.log(element.href);
            return element;
        }
        function newBrElement()
        {
            const element=document.createElement("br");
            return element;
        }
        function main()
        {
            console.log("random");
            fetchProblems(function(problems)
            {
                // console.log(problems);
                const length=problems.length;
                console.log(length);
                const randpos=randint(0,length);
                console.log(randpos);
                const problem=problems[randpos];
                console.log(problem);
                const Element=document.querySelector("div.randomlist");
                console.log(Element);
                Element.insertBefore(newProblemLinker(problem),Element.lastChild.nextSibling);
                Element.insertBefore(newBrElement(),Element.lastChild.nextSibling);
            });
        }
    </script>
    <button onclick="main()">random</button>
    <div class="randomlist">
    </div>
</body>
</html>